#!/bin/bash
export UUID=${UUID:-'b4bcbea6-3455-b752-d12b-de87a5c4a400'}
export SERVER_PORT="${SERVER_PORT:-${PORT:-62670}}"
export NEZHA_SERVER=${NEZHA_SERVER:-'nz.abc.cn'} 
export NEZHA_PORT=${NEZHA_PORT:-'5555'}     
export NEZHA_KEY=${NEZHA_KEY:-''}  
export SNI=${SNI:-'time.is'}
export FILE_PATH=${FILE_PATH:-'./.npm'}  # 节点路径

echo "QVJDSD0kKHVuYW1lIC1tKSAmJiBET1dOTE9BRF9ESVI9IiR7RklMRV9QQVRIfSIgJiYgbWtkaXIgLXAgIiRET1dOTE9BRF9ESVIiICYmIEZJTEVfSU5GTz0oKQppZiBbICIkQVJDSCIgPT0gImFybSIgXSB8fCBbICIkQVJDSCIgPT0gImFybTY0IiBdIHx8IFsgIiRBUkNIIiA9PSAiYWFyY2g2NCIgXTsgdGhlbgogICAgRklMRV9JTkZPPSgiaHR0cHM6Ly9naXRodWIuY29tL2Vvb2NlL3Rlc3QvcmVsZWFzZXMvZG93bmxvYWQvYXJtNjQveHJheSB3ZWIiICJodHRwczovL2dpdGh1Yi5jb20vZW9vY2UvdGVzdC9yZWxlYXNlcy9kb3dubG9hZC9BUk0vc3dpdGggbnBtIikKZWxpZiBbICIkQVJDSCIgPT0gImFtZDY0IiBdIHx8IFsgIiRBUkNIIiA9PSAieDg2XzY0IiBdIHx8IFsgIiRBUkNIIiA9PSAieDg2IiBdOyB0aGVuCiAgICBGSUxFX0lORk89KCJodHRwczovL2dpdGh1Yi5jb20vZW9vY2UvdGVzdC9yZWxlYXNlcy9kb3dubG9hZC9hbWQ2NC94cmF5IHdlYiIgImh0dHBzOi8vZ2l0aHViLmNvbS9lb29jZS90ZXN0L3JlbGVhc2VzL2Rvd25sb2FkL2J1bGlkL3N3aXRoIG5wbSIpCmVsc2UKICAgIGVjaG8gIlVuc3VwcG9ydGVkIGFyY2hpdGVjdHVyZTogJEFSQ0giCiAgICBleGl0IDEKZmkKZm9yIGVudHJ5IGluICIke0ZJTEVfSU5GT1tAXX0iOyBkbwogICAgVVJMPSQoZWNobyAiJGVudHJ5IiB8IGN1dCAtZCAnICcgLWYgMSkKICAgIE5FV19GSUxFTkFNRT0kKGVjaG8gIiRlbnRyeSIgfCBjdXQgLWQgJyAnIC1mIDIpCiAgICBGSUxFTkFNRT0iJERPV05MT0FEX0RJUi8kTkVXX0ZJTEVOQU1FIgogICAgaWYgWyAtZSAiJEZJTEVOQU1FIiBdOyB0aGVuCiAgICAgICAgZWNobyAtZSAiXGVbMTszMm0kRklMRU5BTUUgYWxyZWFkeSBleGlzdHMsU2tpcHBpbmcgZG93bmxvYWRcZVswbSIKICAgIGVsc2UKICAgICAgICBjdXJsIC1MIC1zUyAtbyAiJEZJTEVOQU1FIiAiJFVSTCIKICAgICAgICBlY2hvIC1lICJcZVsxOzMybURvd25sb2FkaW5nICRGSUxFTkFNRVxlWzBtIgogICAgZmkKICAgIGNobW9kICt4ICRGSUxFTkFNRQpkb25lCndhaXQKCiMgR2VuZXJhdGluZyBDb25maWd1cmF0aW9uIEZpbGVzCmdlbmVyYXRlX2NvbmZpZygpIHsKCiAgICBYMjU1MTlLZXk9JCguLyIke0ZJTEVfUEFUSH0vd2ViIiB4MjU1MTkpCiAgICBQcml2YXRlS2V5PSQoZWNobyAiJHtYMjU1MTlLZXl9IiB8IGhlYWQgLTEgfCBhd2sgJ3twcmludCAkM30nKQogICAgUHVibGljS2V5PSQoZWNobyAiJHtYMjU1MTlLZXl9IiB8IHRhaWwgLW4gMSB8IGF3ayAne3ByaW50ICQzfScpCiAgICBzaG9ydGlkPSQob3BlbnNzbCByYW5kIC1oZXggOCkKCiAgY2F0ID4gJHtGSUxFX1BBVEh9L2NvbmZpZy5qc29uIDw8IEVPRgp7CiAgICAiaW5ib3VuZHMiOiBbCiAgICAgICAgewogICAgICAgICAgICAicG9ydCI6ICRTRVJWRVJfUE9SVCwKICAgICAgICAgICAgInByb3RvY29sIjogInZsZXNzIiwKICAgICAgICAgICAgInNldHRpbmdzIjogewogICAgICAgICAgICAgICAgImNsaWVudHMiOiBbCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAiaWQiOiAiYjRiY2JlYTYtMzQ1NS1iNzUyLWQxMmItZGU4N2E1YzRhNDAwIiwKICAgICAgICAgICAgICAgICAgICAgICAgImZsb3ciOiAieHRscy1ycHJ4LXZpc2lvbiIKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgImRlY3J5cHRpb24iOiAibm9uZSIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgInN0cmVhbVNldHRpbmdzIjogewogICAgICAgICAgICAgICAgIm5ldHdvcmsiOiAidGNwIiwKICAgICAgICAgICAgICAgICJzZWN1cml0eSI6ICJyZWFsaXR5IiwKICAgICAgICAgICAgICAgICJyZWFsaXR5U2V0dGluZ3MiOiB7CiAgICAgICAgICAgICAgICAgICAgInNob3ciOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAiZGVzdCI6ICJ0aW1lLmlzOjQ0MyIsCiAgICAgICAgICAgICAgICAgICAgInh2ZXIiOiAwLAogICAgICAgICAgICAgICAgICAgICJzZXJ2ZXJOYW1lcyI6IFsKICAgICAgICAgICAgICAgICAgICAgICAgInRpbWUuaXMiCiAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICAgICAicHJpdmF0ZUtleSI6ICIkUHJpdmF0ZUtleSIsCiAgICAgICAgICAgICAgICAgICAgIm1pbkNsaWVudFZlciI6ICIiLAogICAgICAgICAgICAgICAgICAgICJtYXhDbGllbnRWZXIiOiAiIiwKICAgICAgICAgICAgICAgICAgICAibWF4VGltZURpZmYiOiAwLAogICAgICAgICAgICAgICAgICAgICJzaG9ydElkcyI6IFsKICAgICAgICAgICAgICAgICAgICAgICAgIiRzaG9ydGlkIgogICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIF0sCiAgICAib3V0Ym91bmRzIjogWwogICAgICAgIHsKICAgICAgICAgICAgInByb3RvY29sIjogImZyZWVkb20iLAogICAgICAgICAgICAidGFnIjogImRpcmVjdCIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICAgInByb3RvY29sIjogImJsYWNraG9sZSIsCiAgICAgICAgICAgICJ0YWciOiAiYmxvY2tlZCIKICAgICAgICB9CiAgICBdICAgIAp9CkVPRgp9CmdlbmVyYXRlX2NvbmZpZwoKIyBydW5uaW5nIGZpbGVzCnJ1bigpIHsKICBpZiBbIC1lICIke0ZJTEVfUEFUSH0vbnBtIiBdOyB0aGVuCiAgICBjaG1vZCA3NzcgIiR7RklMRV9QQVRIfS9ucG0iCiAgICB0bHNQb3J0cz0oIjQ0MyIgIjg0NDMiICIyMDk2IiAiMjA4NyIgIjIwODMiICIyMDUzIikKICAgIGlmIFtbICIke3Rsc1BvcnRzWypdfSIgPX4gIiR7TkVaSEFfUE9SVH0iIF1dOyB0aGVuCiAgICAgIE5FWkhBX1RMUz0iLS10bHMiCiAgICBlbHNlCiAgICAgIE5FWkhBX1RMUz0iIgogICAgZmkKICAgIGlmIFsgLW4gIiRORVpIQV9TRVJWRVIiIF0gJiYgWyAtbiAiJE5FWkhBX1BPUlQiIF0gJiYgWyAtbiAiJE5FWkhBX0tFWSIgXTsgdGhlbgogICAgICAgIG5vaHVwICR7RklMRV9QQVRIfS9ucG0gLXMgJHtORVpIQV9TRVJWRVJ9OiR7TkVaSEFfUE9SVH0gLXAgJHtORVpIQV9LRVl9ICR7TkVaSEFfVExTfSA+L2Rldi9udWxsIDI+JjEgJgoJICAgICBzbGVlcCAxCiAgICAgICBlY2hvIC1lICJcZVsxOzMybW5wbSBpcyBydW5uaW5nXGVbMG0iCiAgICBlbHNlCiAgICAgICAgZWNobyAtZSAiXGVbMTszNW1ORVpIQSB2YXJpYWJsZSBpcyBlbXB0eSxza2lwaW5nIHJ1bmluZ1xlWzBtIgogICAgZmkKICBmaQoKICBpZiBbIC1lICIke0ZJTEVfUEFUSH0vd2ViIiBdOyB0aGVuCiAgICBjaG1vZCA3NzcgIiR7RklMRV9QQVRIfS93ZWIiCiAgICBub2h1cCAke0ZJTEVfUEFUSH0vd2ViIC1jICR7RklMRV9QQVRIfS9jb25maWcuanNvbiA+L2Rldi9udWxsIDI+JjEgJgogICAgc2xlZXAgMQogICAgZWNobyAtZSAiXGVbMTszMm13ZWIgaXMgcnVubmluZ1xlWzBtIgogIGZpCgp9CnJ1bgoKIyBnZXQgaXAKSVA9JChjdXJsIC1zIGh0dHBzOi8vaXB2NC5pY2FuaGF6aXAuY29tKQoKIyBnZXQgaXBpbmZvCklTUD0kKGN1cmwgLXMgaHR0cHM6Ly9zcGVlZC5jbG91ZGZsYXJlLmNvbS9tZXRhIHwgYXdrIC1GXCIgJ3twcmludCAkMjYiLSIkMTh9JyB8IHNlZCAtZSAncy8gL18vZycpCgpjYXQgPiAke0ZJTEVfUEFUSH0vbGlzdC50eHQgPDxFT0YKCnZsZXNzOi8vJHtVVUlEfUAke0lQfToke1NFUlZFUl9QT1JUfT9lbmNyeXB0aW9uPW5vbmUmZmxvdz14dGxzLXJwcngtdmlzaW9uJnNlY3VyaXR5PXJlYWxpdHkmc25pPSR7U05JfSZmcD1jaHJvbWUmcGJrPSR7UHVibGljS2V5fSZzaWQ9JHtzaG9ydGlkfSZ0eXBlPXRjcCZoZWFkZXJUeXBlPW5vbmUjJElTUAoKRU9GCmJhc2U2NCAtdzAgJHtGSUxFX1BBVEh9L2xpc3QudHh0ID4gJHtGSUxFX1BBVEh9L3VybC50eHQKY2F0ICR7RklMRV9QQVRIfS91cmwudHh0CmVjaG8gLWUgIlxuXGVbMTszMm0ke0ZJTEVfUEFUSH0vdXJsLnR4dCBzYXZlZCBzdWNjZXNzZnVsbHlcZVswbSIKcm0gLXJmICR7RklMRV9QQVRIfS9saXN0LnR4dCAke0ZJTEVfUEFUSH0vbnBtICR7RklMRV9QQVRIfS93ZWIKZWNobyAiIgpzbGVlcCA4CmNsZWFyCmVjaG8gLWUgIlxuXGVbMTszMm1JbnN0YWxsIHN1Y2Nlc3MhXGVbMG0iCgpleGl0IDA=" | base64 -d | bash
